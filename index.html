<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Be My Valentine?</title>
    <style>
        html,
        body {
            height: 100%;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #ffeef2;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
            overflow: hidden;
        }

        .container {
            background: white;
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            position: relative;
            width: min(420px, 92vw);
        }

        h1 {
            color: #d63384;
            font-size: 1.6rem;
            margin: 0.8rem 0;
        }

        /* make gif area responsive and the bounding box for No button */
        .gif-container {
            position: relative;
            width: min(260px, 60vw);
            height: min(260px, 60vw);
            margin: 0 auto 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            border-radius: 15px;
            background: #fff;
        }

        .gif-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            border-radius: 12px;
        }

        .buttons {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 16px;
            margin-top: 18px;
            position: relative;
            height: 56px;
            /* reserve vertical space so absolute moved No button stays visible */
        }

        button {
            padding: 12px 22px;
            font-size: 1rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.18s ease, left 0.2s ease, top 0.2s ease;
            touch-action: manipulation;
        }

        #yesBtn {
            background-color: #ff4d6d;
            color: #fff;
            z-index: 2;
        }

        #noBtn {
            background-color: #adb5bd;
            color: #fff;
            z-index: 3;
        }

        /* visually greyed out when disabled */
        button:disabled {
            background: #ccc;
            color: #888;
            cursor: not-allowed;
        }

        .success-message {
            display: none;
        }
    </style>
</head>

<body>
    <div class="container" id="mainContainer">
        <div id="askSection">
            <div class="gif-container" id="gifContainer">
                <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExOHY5eXp6Z3RyeGZueGZxeXJ4Z3RxeXJ4Z3RxeXJ4Z3RxeXJ4ZyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/cLS1cfxvGOPVpf9g3y/giphy.gif"
                    alt="Cute Bear" />
            </div>

            <h1>Hey Sana! Will you be my Valentine? üåπ</h1>

            <div class="buttons" id="buttonsRow">
                <button id="yesBtn">Yes!</button>
                <button id="noBtn">No</button>
            </div>
        </div>

        <div id="successSection" class="success-message">
            <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExNXA0bmZ4Z3RxeXJ4Z3RxeXJ4Z3RxeXJ4Z3RxeXJ4Z3RxeXJ4ZyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/26FLdmIp6wJr91JAI/giphy.gif"
                alt="Happy Dance" style="width:100%;max-width:320px;margin:0 auto;display:block;" />
            <h1 style="margin-top: 12px;">Yay! See you on the 14th! ‚ù§Ô∏è</h1>
        </div>
    </div>

    <script>
        const yesBtn = document.getElementById('yesBtn');
        const noBtn = document.getElementById('noBtn');
        const askSection = document.getElementById('askSection');
        const successSection = document.getElementById('successSection');
        const gifContainer = document.getElementById('gifContainer');
        const mainContainer = document.getElementById('mainContainer');

        let yesScale = 1;

        // Helpers
        function updateMeasurements() {
            // ensure measurements reflect current layout
            return {
                gifRect: gifContainer.getBoundingClientRect(),
                mainRect: mainContainer.getBoundingClientRect()
            };
        }

        function clamp(v, a, b) {
            return Math.max(a, Math.min(v, b));
        }

        function moveNoButtonInsideGif() {
            const { gifRect, mainRect } = updateMeasurements();

            // compute available space inside gif container for the No button
            const maxX = Math.max(0, gifRect.width - noBtn.offsetWidth);
            const maxY = Math.max(0, gifRect.height - noBtn.offsetHeight);

            // choose random position inside gif container
            const randX = Math.random() * maxX;
            const randY = Math.random() * maxY;

            // compute offset relative to main container (which is position:relative)
            const offsetLeft = gifRect.left - mainRect.left;
            const offsetTop = gifRect.top - mainRect.top;

            // final position
            const finalLeft = offsetLeft + randX;
            const finalTop = offsetTop + randY;

            // apply position but clamp to remain fully visible inside main container
            const minLeft = 0;
            const maxLeft = mainRect.width - noBtn.offsetWidth;
            const minTop = 0;
            const maxTop = mainRect.height - noBtn.offsetHeight;

            noBtn.style.position = 'absolute';
            noBtn.style.left = clamp(finalLeft, minLeft, maxLeft) + 'px';
            noBtn.style.top = clamp(finalTop, minTop, maxTop) + 'px';
        }

        // Use pointerdown for broad device support; prevent double-fire with touchstart/click
        function addSinglePointerListener(el, handler) {
            el.addEventListener('pointerdown', function pointerHandler(e) {
                handler(e);
            });
            // fallback for older browsers/devices if pointer events not supported
            el.addEventListener('click', handler);
        }

        // When "No" is clicked/touched, enlarge Yes and move No inside GIF area
        addSinglePointerListener(noBtn, () => {
            yesScale += 0.5;
            yesBtn.style.transform = `scale(${yesScale})`;

            // ensure layout settled (image loaded / orientation) before placing
            requestAnimationFrame(() => moveNoButtonInsideGif());
        });

        // When "Yes" is clicked
        addSinglePointerListener(yesBtn, () => {
            askSection.style.display = 'none';
            successSection.style.display = 'block';
        });

        // Keep No button constrained on resize/orientation changes
        function onLayoutChange() {
            // if No is absolute, clamp its position to gif bounds
            if (noBtn.style.position === 'absolute') {
                const { gifRect, mainRect } = updateMeasurements();

                // compute current relative pos to gif
                let left = parseFloat(noBtn.style.left || 0);
                let top = parseFloat(noBtn.style.top || 0);

                const relLeft = left - (gifRect.left - mainRect.left);
                const relTop = top - (gifRect.top - mainRect.top);

                const maxRelX = Math.max(0, gifRect.width - noBtn.offsetWidth);
                const maxRelY = Math.max(0, gifRect.height - noBtn.offsetHeight);

                const clampedRelLeft = clamp(relLeft, 0, maxRelX);
                const clampedRelTop = clamp(relTop, 0, maxRelY);

                noBtn.style.left = (gifRect.left - mainRect.left + clampedRelLeft) + 'px';
                noBtn.style.top = (gifRect.top - mainRect.top + clampedRelTop) + 'px';
            }
        }

        window.addEventListener('resize', () => {
            // wait for layout to stabilize on mobile
            setTimeout(onLayoutChange, 50);
        });
        window.addEventListener('orientationchange', () => setTimeout(onLayoutChange, 150));

        // ensure image loaded before first measurements (helps small screens)
        const img = gifContainer.querySelector('img');
        if (!img.complete) {
            img.addEventListener('load', () => {
                // optional: place 'No' initially inside gif, comment out if you prefer it in flow
                // moveNoButtonInsideGif();
            });
        }
    </script>
</body>

</html>
